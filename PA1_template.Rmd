---
title: "Reproducible Research: Peer Assessment 1"
author: "J Go"
date last updated: "June 11, 2016"
output: 
  html_document:
    keep_md: true
---

## Loading and preprocessing the data
### fork/clone the Coursera repository
### manually fork course project 1 from course github to personal github
```
Open Safari web browser
Login to my github account at https://github.com/JGoDC/
Open another tab for coursera course repo at:
http://github.com/rdpeng/RepData_PeerAssessment1
Click on fork on course github repo page in browser
Select proper destination since a choice exists
Now have forked repo at:
https://github.com/JGoDC/RepData_PeerAssessment1
```
### manually clone course project 1 from github to local machine
```
$ cd ~/coursera/r
$ git clone https://github.com/JGoDC/RepData_PeerAssessment1
Now have cloned repo in new directory on local machine with following files:
~/coursera/r/RepData_PeerAssessment1
drwxr-xr-x  3 j  staff    102 Jun  2 20:34 instructions_fig
drwxr-xr-x  3 j  staff    102 Jun  2 20:34 doc
-rw-r--r--  1 j  staff  53559 Jun  2 20:34 activity.zip
-rw-r--r--  1 j  staff   7776 Jun  2 20:34 README.md
-rw-r--r--  1 j  staff    358 Jun  2 20:34 PA1_template.Rmd
```
### note clone date and time from timestamp on files
```
Jun 02, 2016, 20:34 EST
```
### require needed packages
```{r load_packages}
library(dplyr)
library(lubridate)      # for date functions
library(ggplot2)
```

### examine current directory and current files
```{r examine_current_dir_and_files}
getwd()
dir(full.names = TRUE, recursive = TRUE)
```
### check for "data" directory, create if necessary
```{r check_existence_data_dir}
data_dir="./data"
if (!file.exists(data_dir)) {
    dir.create(data_dir)
} else {
    cat('data dir exists: [', data_dir, ']', '\n')
}
```

### check for activity.csv file, unzip activity.zip into data dir if necessary
```{r check_existence_file_activity.csv}
data_file <- paste0(file.path(".", "data", "activity.csv"))
if(!file.exists(data_file)) {
        zip_file <- "activity.zip"
        unzip(zip_file, exdir = data_dir )
} else {
    cat('data file exists: [', data_file, ']', '\n')
}
```

### read input data file with read.csv
```{r read_input_data}
dat <- read.csv( "./data/activity.csv", sep=",", stringsAsFactors = FALSE )

# closeAllConnections()	# doesn't always prevent warnings on unused connections

```

### summarise total steps by date, create a histogram plot:
```{r summarise_total_steps_by_date}
dat_df <- tbl_df(dat)
dat_date_total_steps <- summarise(group_by(dat_df, date), sum(steps, na.rm = T))
unique_dates <- as.Date(names(table(dat$date)))
step_totals <- as.numeric(unlist(dat_date_total_steps[2]))

plot(unique_dates, step_totals, type="s", lwd=2, col="green", pch=2, 
     xlab="Dates", ylab="Total Steps", main="Total Steps Per Day")
lines(unique_dates, step_totals, type="h", lwd=2, col="green")
```

## What is mean and median of the total number of steps taken per day?
```{r mean_and_median_of_total_steps_by_date}
# mean steps taken in a day over the entire 61 day period [9354.23]
mean_of_total_steps_per_day <- mean(as.numeric(unlist(dat_date_total_steps[,2])))
# median steps taken in a day over the entire 61 day period [10395]
median_of_total_steps_per_day <- median(as.numeric(unlist(dat_date_total_steps[,2])))
```

### The mean of the total number of steps taken in a day is:
`r I(mean_of_total_steps_per_day)`

### The median of the total number of steps taken in a day is: 
`r I(median_of_total_steps_per_day)`

## What is the average daily activity pattern?
```{r mean_steps_by_5_minute_intervals}
average_total_steps_per_interval <- summarise(group_by(dat_df, interval), mean(steps, na.rm = T))
step_average_per_interval <- as.numeric(unlist(average_total_steps_per_interval[2]))
intervals <- as.numeric(unlist(average_total_steps_per_interval[1]))

plot(intervals, step_average_per_interval, type="l", lwd=2, col="purple", pch=2,
     xlab="Five Minute Intervals", ylab="Average Steps", main="Average Steps Per Interval")
```

### Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?

```{r interval_with_max_steps}
max_number_steps_perinterval <- max(step_average_per_interval) # 206.1698

library(nnet)
num_max_step_interval <- which.is.max(step_average_per_interval) # 104th interval has max value

interval_max_steps <- intervals[which.is.max(step_average_per_interval)]    # corresponds to 835 ie 08:35 AM
```

### The interval which has the maximum number of steps is this interval corresponding to the time 8:35 AM: 
`r I(interval_max_steps)`

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
